/* Scratch-built minimalist yet modern UI */
:root {
  --bg: #0f1115;
  --bg-alt: #161a21;
  --bg-elev: #1e242d;
  --border: #2b323c;
  --text: #e6edf3;
  --text-dim: #9aa4b1;
  --brand: #6366f1;
  --brand-accent: #8b5cf6;
  --danger: #ef4444;
  --radius-sm: 4px;
  --radius-md: 8px;
  --radius-lg: 14px;
  --shadow: 0 4px 14px -2px rgba(0,0,0,.4);
  --grad-brand: linear-gradient(135deg,var(--brand),var(--brand-accent));
  font-family: 'Inter', system-ui, -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
}

html[data-theme='light'] {
  --bg: #f5f7fb;
  --bg-alt: #ffffff;
  --bg-elev: #f1f4f9;
  --border: #d9e1ec;
  --text: #1f2630;
  --text-dim: #647084;
  --shadow: 0 4px 16px rgba(0,0,0,.08);
}

body { margin:0; background: var(--bg); color: var(--text); }
* { box-sizing: border-box; }

.app-shell { display:flex; height:100vh; width:100%; overflow:hidden; }
aside.sidebar { width:300px; background: var(--bg-alt); border-right:1px solid var(--border); display:flex; flex-direction:column; padding:1rem .9rem; gap:1.2rem; overflow-y:auto; }
.brand { font-weight:600; display:flex; gap:.6rem; align-items:center; font-size: .95rem; padding:.4rem .6rem; background:var(--grad-brand); border-radius: var(--radius-md); color:#fff; box-shadow: var(--shadow); }
.brand .logo { font-size:1.1rem; }
.section { display:flex; flex-direction:column; gap:.6rem; }
.section-head { display:flex; align-items:center; justify-content:space-between; font-size:.7rem; letter-spacing:.08em; text-transform:uppercase; color:var(--text-dim); font-weight:600; }
.section-head button.tiny { background:none; border:1px solid var(--border); color:var(--text-dim); padding:.15rem .35rem; border-radius:var(--radius-sm); cursor:pointer; font-size:.65rem; }
.section-head button.tiny:hover { color: var(--text); border-color: var(--text-dim); }

.convo-list { display:flex; flex-direction:column; gap:.4rem; }
.convo-list.empty { font-size:.75rem; font-style:italic; color:var(--text-dim); }
.conversation-item { text-align:left; border:1px solid var(--border); background: var(--bg-elev); color:var(--text); padding:.55rem .6rem; border-radius: var(--radius-md); display:flex; align-items:center; justify-content:space-between; gap:.5rem; cursor:pointer; font-size:.75rem; position:relative; }
.conversation-item.active { outline:2px solid var(--brand); }
.conversation-item:hover { background: var(--bg-alt); }
.conversation-item .count { font-size:.55rem; background:var(--brand); color:#fff; padding:.15rem .35rem; border-radius:20px; }

.entity-panel { display:flex; flex-direction:column; gap:.4rem; font-size:.7rem; }
.entity-panel .placeholder { font-style:italic; color:var(--text-dim); }
.entity-chip { background:var(--bg-elev); border:1px solid var(--border); padding:.35rem .5rem; border-radius: var(--radius-lg); display:flex; align-items:center; gap:.4rem; }
.entity-chip .k { color:var(--text-dim); font-weight:500; }

.settings-group { display:flex; flex-direction:column; gap:.55rem; font-size:.7rem; }
.settings-group label { display:flex; flex-direction:column; gap:.3rem; font-weight:500; }
.settings-group input[type=range] { width:100%; }
.settings-group input[type=number] { background:var(--bg-elev); border:1px solid var(--border); padding:.35rem .5rem; border-radius: var(--radius-sm); color:var(--text); }

.footer { margin-top:auto; display:flex; gap:.5rem; }
button { font-family:inherit; }
button.primary { background: var(--grad-brand); color:#fff; border:none; padding:.65rem .95rem; font-weight:600; border-radius: var(--radius-md); cursor:pointer; font-size:.8rem; }
button.primary:hover { filter:brightness(1.05); }
button.secondary, button.ghost { background: var(--bg-elev); color: var(--text); border:1px solid var(--border); padding:.55rem .8rem; border-radius: var(--radius-md); font-size:.7rem; cursor:pointer; }
button.secondary:hover, button.ghost:hover { background: var(--bg-alt); }
button.ghost { background: transparent; }
button:disabled { opacity:.4; cursor:not-allowed; }

.main { flex:1; display:flex; flex-direction:column; overflow:hidden; }
.topbar { height:54px; display:flex; align-items:center; justify-content:space-between; padding:0 1rem; border-bottom:1px solid var(--border); background:var(--bg-alt); }
.topbar .breadcrumbs { font-size:.8rem; font-weight:600; }
.topbar .actions { display:flex; gap:.5rem; }

.chat { flex:1; overflow-y:auto; padding:1.1rem 1.25rem 1.5rem; display:flex; flex-direction:column; gap:.9rem; background:linear-gradient(to bottom,var(--bg),var(--bg-alt)); }
.welcome { text-align:left; max-width:700px; }
.welcome h2 { margin:0 0 .4rem; font-size:1.2rem; }
.quick-grid { margin-top:.8rem; display:grid; grid-template-columns:repeat(auto-fill,minmax(150px,1fr)); gap:.5rem; }
.quick-grid button { background:var(--bg-elev); border:1px solid var(--border); color:var(--text-dim); font-size:.65rem; padding:.5rem .6rem; border-radius: var(--radius-md); cursor:pointer; }
.quick-grid button:hover { color:var(--text); border-color:var(--text-dim); }

.msg { display:flex; gap:.75rem; max-width:820px; animation: fade .25s ease; }
.msg[data-role=user] { flex-direction: row-reverse; margin-left:auto; }
.avatar { width:38px; height:38px; border-radius:50%; background:var(--grad-brand); display:flex; align-items:center; justify-content:center; font-weight:600; font-size:.8rem; color:#fff; box-shadow: var(--shadow); flex-shrink:0; }
.msg[data-role=assistant] .avatar { background:#0ea5e9; }
.bubble { position:relative; background:var(--bg-elev); border:1px solid var(--border); padding:.8rem .95rem; border-radius: var(--radius-lg); font-size:.78rem; line-height:1.4; width:100%; }
.msg[data-role=user] .bubble { background:var(--grad-brand); border:none; color:#fff; }
.bubble .meta { margin-top:.45rem; font-size:.55rem; letter-spacing:.05em; opacity:.65; text-transform:uppercase; }
.bubble pre, .bubble code { background:#10151c; padding:.55rem .65rem; border-radius: var(--radius-sm); font-family: ui-monospace,Menlo,monospace; font-size:.7rem; display:block; overflow-x:auto; }
html[data-theme='light'] .bubble pre, html[data-theme='light'] .bubble code { background:#edf1f7; color:#1f2630; }

.composer { border-top:1px solid var(--border); background:var(--bg-alt); padding:.7rem .85rem .9rem; display:flex; flex-direction:column; gap:.6rem; }
.composer textarea { width:100%; resize:none; border:1px solid var(--border); border-radius: var(--radius-lg); background:var(--bg-elev); color:var(--text); padding:.75rem .85rem; font-size:.8rem; line-height:1.35; max-height:200px; min-height:48px; outline:none; }
.composer textarea:focus { border-color: var(--brand); box-shadow: 0 0 0 1px var(--brand) inset; }
.composer-actions { display:flex; gap:.5rem; align-items:flex-end; }
.composer .hint { font-size:.55rem; color:var(--text-dim); text-align:right; }

.loading { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; backdrop-filter: blur(4px); background:rgba(0,0,0,.35); gap:.85rem; font-size:.8rem; font-weight:500; color:#fff; z-index:50; }
.loading.hidden { display:none; }
.spinner { width:28px; height:28px; border:3px solid rgba(255,255,255,.2); border-top-color:#fff; border-radius:50%; animation: spin 1s linear infinite; }

.toasts { position:fixed; top:1rem; right:1rem; display:flex; flex-direction:column; gap:.5rem; z-index:100; }
.toast { background:var(--bg-alt); border:1px solid var(--border); padding:.65rem .8rem; font-size:.65rem; border-radius: var(--radius-md); box-shadow: var(--shadow); display:flex; gap:.6rem; align-items:center; }
.toast.success { border-color: var(--brand); }
.toast.error { border-color: var(--danger); }

@keyframes spin { to { transform: rotate(360deg);} }
@keyframes fade { from {opacity:0; transform:translateY(4px);} to {opacity:1; transform:translateY(0);} }

@media (max-width: 860px){
  aside.sidebar { position:fixed; inset:0 40% 0 0; max-width:300px; z-index:120; transform:translateX(-100%); transition:.3s ease; }
  aside.sidebar.open { transform:translateX(0); }
  .main { padding-left:0; }
}
